================================================================================
Project RISCII: Memory Chip Notes
---
"Notes regarding MCU expectations on hooked up memory/storage chips"
================================================================================
Table of Contents:
    -> Purpose
    -> Memory Chip Notes
    -> Storage Chip Notes
    
================================================================================
Purpose:

    This document is intended to capture the MCU's general expectations 
    regarding the memory chips externally hooked up to the MCU. These 
    expectations should be used for future chip selection during board design.

    The following assumptions apply to all external chips:
        1) External chip and MCU share same voltage level/characteristics
        2) External chip can handle at least 10 MHz signals (ie 8 MHz + buffer)

================================================================================
Memory Chip Notes:

    The "memory" chip is used to store instructions and data during runtime. 
    Both memory access paths from the core processor route to this chip, along 
    with the JTAG (for SW debugging) and Boot Block (for initializing).
    
    The chip shall be 96 KB large and word-addressable with a parallel access 
    port (ie 16-bit address accessing 2 bytes per access). The tables below 
    explain the expected port connections and how MCU uses the memory space.
    
    Given the above description, an SRAM chip may fit the task best.
    
    == Pin Connections ==
    name | bitwidth | MCU active | direction    | desc.
    -----+----------+------------+--------------+------
    addr | 16       | ---        | from MCU     | Sets address to read/write
    data | 16       | ---        | bidrectional | Data being read or written
    Wr   | 1        | Wr = high  | from MCU     | Sets access/data direction
    En   | 1        | high       | from MCU     | Enables/triggers access
    
    Some chip models may have additional signals (eg byte masks). These signals 
    can often be held at a constant value or be handled with minor pin/logic 
    additions to a wrapper module around the main softcore MCU design.
    
    == Memory Usage ==
    range         | name      | desc.
    --------------+-----------+------
    0xC000-0xFFFF | unused    | mapped addresses in MCU- unused on chip
    0x8000-0xBFFF | live data | data used during runtime
    0x0000-0x7FFF | live prgm | instructions used during runtime
    
    While only 96 KB of the chip are used, it may be easier to find a 128 KB 
    chip. It may also may be easier to use multiple, smaller chips vs one 
    larger one (eg two byte addressable chips vs one word addressable chip).

================================================================================
Storage Chip Notes:

    The "storage" chip is used to store the binary image between power cycles. 
    It is programmable via the MCU's JTAG port and mapped storage peripheral, 
    and has its contents copied into the "memory" chip upon a hardware reset. 
    
    The chip is directly controlled by the MCU's Boot Block and indirectly 
    controlled by the JTAG and mapped storage peripheral (ie Boot Block 
    hardware and JTAG/peripheral software rely on storage chip details).
    
    The chip shall be 64 KB large with a SPI connection (CPOL/CPHA = 0, MSb). 
    The chip shall accept 1 byte commands and 2 byte addresses with bytes 
    read/written to sequential addresses; Reads shall stream bits indefinitely. 
    
    The tables below explain the expected port connections and how the MCU uses 
    the memory space.
    
    Given the above description, a SPI EEPROM chip may fit the task best.
    
    == Pin Connections ==
    name | bitwidth | MCU active | direction | desc.
    -----+----------+------------+-----------+------
    SCK  | 1        | idle = low | from MCU  | Serial Clock, generated by MCU
    SDI  | 1        | ---        | from MCU  | "Slave Data In" (data from MCU)
    SDO  | 1        | ---        | to MCU    | "Slave Data Out" (data to MCU)
    SCS  | 1        | high       | from MCU  | Serial Chip Select (active low)
    
    Some chip models may have additional signals (eg write protection). These 
    signals can often be held at a constant value or be handled with minor 
    pin/logic additions to a wrapper module around the main softcore MCU design.
    
    == Expected Binary Format ==
    address   | field name          | length   | desc.
    ----------+---------------------+----------+------
    <lowest>  | .text final address | 2 bytes  | last memory .text address used
    ---       | .text section       | 2+ bytes | .text section values
    ---       | .data final address | 2 bytes  | last memory .data address used
    <highest> | .data section       | 2+ bytes | .data section values
    
    Upon a hardware reset, the chip's contents are read by the MCU's Boot 
    Block, which copies the .text section values and .data section values to 
    the memory chip, starting at respective addresses 0x000 and 0x8000.
    
================================================================================
